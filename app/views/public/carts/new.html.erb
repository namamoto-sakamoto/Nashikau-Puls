<h4>注文フォーム</h4>
<div class="table_block">
  <%= form_with model:@cart, url: public_carts_path, method: :post, local:true do |f| %>
    <table class="table table-borderless">
      <tbody>
        <tr>
          <td>注文者</td>
          <td><%= @customer.full_name %></td>
          <%= f.hidden_field :customer_id, :value => @customer.id %>
        </tr>
        <tr>
          <td><%= f.label :jpear, "品種" %></td>
          <td>
            <%= f.select(:jpear, @jpear.map{ |jpear| [jpear.name, jpear.id] }, {id: "jpear_select"})%>
          </td>
        </tr> 
        <!--選択した品種で登録してある販売商品をチェックボックスで表示したい-->
        <tr>
          <th></th>
          <th>商品名<th>
          <th>値段<th>
          <th>個数選択<th>
        </tr>
        <tr>
          <td><%= f.label :product_type, "販売商品" %></td>
          <div class="field">
            <%= f.label :梨タイプ %><br>
            <%= f.select(:product_type, @product_types, {id: 'product_type_select'}) %>
          </div>
          <% @product_types.map do |p| %>
            <td><%= p[0] %></td>
            <td><%= p[1] %></td>
            <td><%= f.select :amount, *[1..40] %><td>
          <% end  %>
        </tr>
        <!--お届け先選択(ラジオボタン)-->
          <tr>
            <td><%= f.label :delivery, "お届け先" %></td>
            <td>
              <%= f.radio_button :delivery_method, "take_out" %>
              <%= f.label :delivery_method, "お持ち帰り" %>
            </td>
          </tr>
          <tr>
            <td>
              <%= f.radio_button :delivery_method, "registered_address" %>
              <%= f.label :delivery_method, "登録済みの住所から選択" %>
              <%#= f.select :delivery_id, options_from_collection_for_select(@deliveries) %>
              <%#= f.select :address_id, options_from_collection_for_select(@delivery, :id, :address_display) %>
            </td>
          </tr>  
          <table class="table table-borderless">
            <tr>
              <td>
                <%= f.radio_button :delivery_method, "new_address" %>
                <%= f.label :delivery_method, "新規送り先住所を登録" %>
              </td>
            </tr>
            <tr>
              <th><%= f.label :postcode, "郵便番号" %></th>
              <td><%= f.text_field :postcode %></td>
            </tr>
            <tr>
              <th><%= f.label :address, "住所" %></th>
              <td><%= f.text_field :address %></td>
            </tr>
            <tr>
              <th><%= f.label :name, "宛名" %></th>
              <td><%= f.text_field :name %></td>
            </tr>
            <tr>
              <th><%= f.label :name_kana, "宛名（カナ）" %></th>
              <td><%= f.text_field :name_kana %></td>
            </tr>
            <tr>
              <th><%= f.label :phone_number, "連絡先電話番号" %></th>
              <td><%= f.text_field :phone_number %></td>
            </tr>  
          </table>
        <tr>
          <th><%= f.label :memo, "メモ" %></th>
          <td><%= f.text_field :memo %></td>
        </tr>
        <div>
          <tr>
            <%= f.button :type => "submit", class: 'btn btn-warning mt-3' do %>
              <div><i class="fa-solid fa-cart-plus"></i> カートへ追加する </div>
            <% end %>
          </tr>
        </div>
      </tbody>
    </table>
  <% end %>  
</div>  

<script type="text/javascript">
  $(document).ready(function(){
    // 品種選択
    $('#jpear_select').change(function(){
      var jpear_id = 1;
      byebug
      $.get("<%= public_carts_product_type_select_path %>",
        { jpear_id: jpear_id },
        function(data){ }
      );
    });
</script>